<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.4.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=author content="Eric Boittier"><meta name=description content="Fortan go &#34;brrr&#34;... but can we make it go faster? Profiling code is the best way to improve efficiency. Here you'll find a short explanation on how to do this in Fortran."><link rel=alternate hreflang=en-us href=https://ericboittier@githubpages.io/post/profiling-fortan/><meta name=theme-color content="#1565c0"><link rel=stylesheet href=/css/vendor-bundle.min.f1ecf783c14edc00c9320c205831ad8e.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css integrity="sha512-W0xM4mr6dEP9nREo7Z9z+9X70wytKvMGeDsj7ps2+xg5QPrEBXC8tAW1IFnzjR6eoJ90JmCnFzerQJTLzIEHjA==" crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=stylesheet href=/css/wowchemy.d3fbabf3e02f0a40f84592dd992c35ca.css><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu9ac327d6012d36714959b8b60a0f0d52_7608_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu9ac327d6012d36714959b8b60a0f0d52_7608_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://ericboittier@githubpages.io/post/profiling-fortan/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wowchemy"><meta property="twitter:creator" content="@wowchemy"><meta property="og:site_name" content="Eric Boittier"><meta property="og:url" content="https://ericboittier@githubpages.io/post/profiling-fortan/"><meta property="og:title" content="Fortran is fast. Profile your code to make it faster! | Eric Boittier"><meta property="og:description" content="Fortan go &#34;brrr&#34;... but can we make it go faster? Profiling code is the best way to improve efficiency. Here you'll find a short explanation on how to do this in Fortran."><meta property="og:image" content="https://ericboittier@githubpages.io/post/profiling-fortan/featured.jpg"><meta property="twitter:image" content="https://ericboittier@githubpages.io/post/profiling-fortan/featured.jpg"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2022-08-17T00:00:00+00:00"><meta property="article:modified_time" content="2022-08-17T00:00:00+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://ericboittier@githubpages.io/post/profiling-fortan/"},"headline":"Fortran is fast. Profile your code to make it faster!","image":["https://ericboittier@githubpages.io/post/profiling-fortan/featured.jpg"],"datePublished":"2022-08-17T00:00:00Z","dateModified":"2022-08-17T00:00:00Z","author":{"@type":"Person","name":"Eric Boittier"},"publisher":{"@type":"Organization","name":"Eric Boittier","logo":{"@type":"ImageObject","url":"https://ericboittier@githubpages.io/media/icon_hu9ac327d6012d36714959b8b60a0f0d52_7608_192x192_fill_lanczos_center_3.png"}},"description":"Fortan go \"brrr\"... but can we make it go faster? Profiling code is the best way to improve efficiency. Here you'll find a short explanation on how to do this in Fortran."}</script><title>Fortran is fast. Profile your code to make it faster! | Eric Boittier</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=73f54d34305b16238c06c5395b9d0e5c><script src=/js/wowchemy-init.min.9e9fa4b2ccd29f9edfae161d14d2effd.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Eric Boittier</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Eric Boittier</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/#posts><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/#publications><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/#contact><span>Contact</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></header></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>Fortran is fast. Profile your code to make it faster!</h1><p class=page-subtitle>Profiling Fortran code with gprof</p><div class=article-metadata><div><span>admin</span></div><span class=article-date>Aug 17, 2022</span>
<span class=middot-divider></span>
<span class=article-reading-time>2 min read</span>
<span class=middot-divider></span>
<span class=article-categories><i class="fas fa-folder mr-1"></i><a href=/category/optimization/>optimization</a>, <a href=/category/programming/>programming</a></span></div></div><div class="article-header container featured-image-wrapper mt-4 mb-4" style=max-width:563px;max-height:402px><div style=position:relative><img src=/post/profiling-fortan/featured_hue58bc8a91aa817f58a85d47da67a5c96_60942_1200x2500_fit_q75_h2_lanczos.webp width=563 height=402 alt class=featured-image>
<span class=article-header-caption>Image credit: <a href=https://boardgamegeek.com/image/78330/fortran target=_blank rel=noopener><strong>Boardgamegeek</strong></a></span></div></div><div class=article-container><div class=article-style><h2 id=all-about-fortran>All About Fortran</h2><h3 id=what-is-fortran>What is Fortran?</h3><p>Fortran is a dinosaur code language. It was released around 65 years ago (date of writing) by John Backus and IBM for electric computing machines powered by the fossilized remains of dinosaurs who lived around 65 million years ago.</p><p>&lsquo;Too lazy&rsquo; to write assembly, Backus wrote this compiled imperative language to save himself time when composing complicated mathematical formulas, giving rise to the &lsquo;Formula Translation&rsquo; language or FORTRAN. Nowadays, FORTRAN is considered too verbose by modern programming standards. Although much slower, Python might be considered the new Formula Translation language. Routines like the Fast Fourier Transform have been reduced to one line (np.fft()), where the number of lines of pure FORTRAN and assembly code needed are around 1 to 2 orders of magnitude longer, respectively.</p><h3 id=why-fortran>Why Fortran?</h3><p>Fortran is fast. Many legacy applications rely on Fortran for reasons related to speed and compatibility.</p><h2 id=the-good-type-of-profiling>The Good Type of Profiling</h2><h3 id=how-can-we-test-the-speed-of-our-code>How can we test the speed of our code?</h3><p>Profiling is a strategy to monitor the performance of one&rsquo;s code.
Results often show the time spent in individual routines, the number of calls, as well as the order in which routines have been accessed.</p><h2 id=profiling-fortran-with-gprof>Profiling Fortran with gprof</h2><p>Fortran must first be compiled with the following, additional flags:</p><pre><code class=language-bash>... -pg fcheck=bounds,mem
</code></pre><p>The &lsquo;fcheck&rsquo; option allows the compiler to produce warnings for attempts at accessing undefined memory, etc.</p><p>Once compiled, run your code as usual:</p><pre><code class=language-bash>./yourcode 
</code></pre><p>A file named &lsquo;gmon.out&rsquo; will be created in the current directory.
To see the results of the profiling</p><pre><code class=language-bash>gprof -l -b ./yourcode &gt; gprof.log
</code></pre><p>The -g and -l flags in the compilation and profiling steps, respectively, allow for a line by line analysis of time spent during computation. Without these options, the profiler will show total time spent in each subroutine.</p></div><div class=article-tags><a class="badge badge-light" href=/tag/code/>code</a>
<a class="badge badge-light" href=/tag/fortran/>fortran</a></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class="powered-by copyright-license-text">© 2024 Me. This work is licensed under <a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank>CC BY NC ND 4.0</a></p><p class="powered-by footer-license-icons"><a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank aria-label="Creative Commons"><i class="fab fa-creative-commons fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-by fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nc fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nd fa-2x" aria-hidden=true></i></a></p><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> — the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/js/vendor-bundle.min.d26cbef546776b4d6032d1ea3dafadab.js></script>
<script src=https://cdn.jsdelivr.net/gh/desandro/imagesloaded@v4.1.4/imagesloaded.pkgd.min.js integrity="sha512-S5PZ9GxJZO16tT9r3WJp/Safn31eu8uWrzglMahDT4dsmgqWonRY9grk3j+3tfuPr9WJNsfooOR7Gi7HL5W2jw==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/metafizzy/isotope@v3.0.6/dist/isotope.pkgd.min.js integrity="sha512-Zq2BOxyhvnRFXu0+WE6ojpZLOU2jdnqbrM1hmVdGzyeCa1DgM3X5Q4A/Is9xA1IkbUeDd7755dNNI/PzSf2Pew==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/highlight.min.js integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/r.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/latex.min.js crossorigin=anonymous></script>
<script id=search-hit-fuse-template type=text/x-template>
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script>
<script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.c251366b4128fd5e6b046d4c97a62a51.js type=module></script>
<script src=/en/js/wowchemy.min.1ed7170a9173a61f55662bbf6cc675b2.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=/js/wowchemy-publication.b0d291ed6d27eacec233e6cf5204f99a.js type=module></script></body></html>